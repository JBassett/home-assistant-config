- alias: 'Garage Door - Left Open Notification'
  id: f2e584e1-3c07-4da2-ac24-99ada3fd659f
  initial_state: 'on'
  mode: restart
  trigger:
    - platform: state
      entity_id: sensor.home_status
      to: 'Unoccupied'
      for:
        minutes: 5
  condition:
    - condition: state
      entity_id: cover.garage_door_opener
      state: open
  action:
    - service: notify.mobile_app_pixel_4a
      data:
        message: Looks like the garage was left open!! {{ now().strftime("%H:%M") }}
        title: Garage left open!
        data:
          actions:
          - action: close_garage
            title: Close Door
    - wait_for_trigger:
      - platform: event
        event_type: mobile_app_notification_action
        event_data:
          action: close_garage
    
    - service: cover.close_cover
      data:
        entity_id: cover.garage_door_opener

- alias: 'Garage Door - Opened/Closed not home'
  id: 52340028-d645-4654-9c06-ee4158ef027b
  initial_state: 'on'
  mode: restart
  trigger:
    - entity_id: cover.garage_door_opener
      platform: state
  condition:
    - condition: state
      entity_id: sensor.home_status
      state: Unoccupied
  action:
    - service: notify.mobile_app_pixel_4a
      data:
        title: 'Garage Door: {{ states(''cover.garage_door_opener'') }}'
        message: Garage is now {{ states('cover.garage_door_opener') }} at {{ now().strftime("%H:%M") }}
        data:
          actions:
            - action: close_garage
              title: Close Door
    - wait_for_trigger:
      - platform: event
        event_type: mobile_app_notification_action
        event_data:
          action: close_garage
    
    - service: cover.close_cover
      data:
        entity_id: cover.garage_door_opener
